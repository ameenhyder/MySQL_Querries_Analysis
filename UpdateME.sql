UPDATE `atentotfn_fixedsales.smetable`
SET Carrier_AC = ifnull(
(case 
	when (Substring(BTN, 1, 1) ='9' and Substring(BTN, 3, 2)  in ('96','97','98','99') ) then 'Amazonia_Celular'
    when ((Substring(BTN, 1, 1) ='4' and Substring(BTN, 3, 2)   in ('84','85') ) or (  Substring(BTN, 1, 1) ='5' and Substring(BTN, 3, 2)   in ('84','85') ) or ( Substring(BTN, 1, 1) ='6' and Substring(BTN, 3, 2)   in ('84','85') ) or ( Substring(BTN, 3, 2) in  ('61','62','63','64','65','66','67','68','69','91','92', '93', '94', '95', '96', '97', '98', '99') and Substring(BTN, 3, 2)   in ('86'))) then 'Brasil_Telecom'
    when ((Substring(BTN, 1, 1) ='2' and Substring(BTN, 3, 2)  in ('91','92','93','94') ) or (  Substring(BTN, 1, 1) ='3' and Substring(BTN, 3, 2)  in ('81','82','83','84')) or ( Substring(BTN, 1, 1) ='7' and Substring(BTN, 3, 2)  in ('81','82','83')) or ( Substring(BTN, 1, 1) ='8' and Substring(BTN, 3, 2)   in ('91','92','93','94') ) or ( Substring(BTN, 1, 1) ='4' and Substring(BTN, 3, 2)   in ('87','88') ) or ( Substring(BTN, 1, 1) ='5' and Substring(BTN, 3, 2)   in ('91','92','93','94') ) or (  Substring(BTN, 1, 1) ='6' and Substring(BTN, 3, 2)   in ('91','92','93','94')) or ( Substring(BTN, 1, 1) ='1' and Substring(BTN, 3, 2)  in  ('91','92','93','94') ) or ( Substring(BTN, 3, 2) in  ('61','62','63','64','65','66','67','68','69','91','92', '93', '94', '95', '96', '97', '98', '99') and Substring(BTN, 3, 4)  in ('9551', '9552', '9553', '9554', '9555', '9556', '9557', '9558', '9559','9981', '9982', '9983', '9984', '9985', '9986', '9987', '9988', '9989') ) or (  Substring(BTN, 3, 2) = '11' and Substring(BTN, 3, 2) ='95')) then 'Claro'
    when (Substring(BTN, 3, 1)  in ('2','3','4','5') ) then 'Landline'
    when ((Substring(BTN, 1, 1) ='2' and Substring(BTN, 3, 2)   in ('87','88')) or ( Substring(BTN, 1, 1) ='9' and Substring(BTN, 3, 2)  in ('87','88')) or ( Substring(BTN, 1, 1) ='3' and Substring(BTN, 3, 2)  in ('87','88')) or ( Substring(BTN, 1, 1) ='7' and Substring(BTN, 3, 2)   in ('87','88')) or ( Substring(BTN, 1, 1) ='8' and Substring(BTN, 3, 2)  in ('87','88')) or ( Substring(BTN, 1, 1) ='1' and Substring(BTN, 3, 2)  in ('81','82','83','84','85','86','89') ) or (  Substring(BTN, 3, 2) in ('71', '73', '74', '75', '77', '79', '81', '82', '83', '84', '85', '86', '87', '88', '89') and Substring(BTN, 3, 2)  in ('84','85','86'))) then 'OI'
    when (Substring(BTN, 1, 1) ='3' and Substring(BTN, 3, 2)  in ('96','97','98','99')) then 'Telemig_Celular'
    when ((Substring(BTN, 1, 1) ='8' and Substring(BTN, 3, 2)  in ('96','97','98','99') ) or (  Substring(BTN, 1, 1) ='4' and Substring(BTN, 3, 2)  in  ('96','97','98','99') ) or (  Substring(BTN, 1, 1) ='9' and Substring(BTN, 3, 2)  in ('80','81','82','83')) or ( Substring(BTN, 1, 1) ='2' and Substring(BTN, 3, 2)  in ('80','81','82','83')) or ( Substring(BTN, 1, 1) ='7' and Substring(BTN, 3, 2)   in ('91','92','93','94') ) or ( Substring(BTN, 1, 1) ='3' and Substring(BTN, 3, 2)   in ('91','92','93','94') ) or ( Substring(BTN, 1, 1) ='5' and Substring(BTN, 3, 2)  in   ('81','82') ) or (  Substring(BTN, 1, 1) ='6' and Substring(BTN, 3, 2)  in   ('81','82') ) or (  Substring(BTN, 1, 1) ='1' and Substring(BTN, 3, 2)  in  ('81','82','83','84','85','86','87') ) or (  Substring(BTN, 3, 2) in ('71', '73', '74', '75', '77', '79', '81', '82', '83', '84', '85', '86', '87', '88', '89')  and Substring(BTN, 3, 4) in('8719', '8720', '8721') ) or ( Substring(BTN, 3, 2) in ('71', '73', '74', '75', '77', '79', '81', '82', '83', '84', '85', '86', '87', '88', '89') and Substring(BTN, 3, 2)  = '88') ) then 'TIM'
    when ((Substring(BTN, 1, 1) ='2' and Substring(BTN, 3, 2)  in ('96','97','98','99') ) or (  Substring(BTN, 1, 1) ='1' and Substring(BTN, 3, 2)  in  ('96','97','98','99') ) or (  Substring(BTN, 1, 1) ='9' and Substring(BTN, 3, 2)  in ('91','92','93','94') ) or (  Substring(BTN, 1, 1) ='8' and Substring(BTN, 3, 1)  = '8' ) or ( Substring(BTN, 1, 1) ='4' and Substring(BTN, 3, 2)   in ('91','92','93','94') ) or ( Substring(BTN, 1, 1) ='7' and Substring(BTN, 3, 2)  in  ('96','97','98','99') ) or (  Substring(BTN, 1, 1) ='5' and Substring(BTN, 3, 2)  in  ('96','97','98','99') ) or (  Substring(BTN, 1, 1) ='6' and Substring(BTN, 3, 2)  in  ('96','97','98','99') ) or ( Substring(BTN, 3, 2) in ('71', '73', '74', '75', '77', '79', '81', '82', '83', '84', '85', '86', '87', '88', '89') and Substring(BTN, 3, 4) in ('8100','8200') ) or (  Substring(BTN, 3, 2) = '21' and Substring(BTN, 3, 2)  in  ('71','72','95')) ) then 'Vivo'
	when (Substring(BTN, 1, 2) ='11' and Substring(BTN, 3, 2)  = '95' ) then 'Vivo'
end), 'NA')
Where calltime >= '2018-09-01'
;